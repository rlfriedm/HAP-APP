<h1><%=@trail.name %> </h1>
<h1> Rating: <%=@trail.rating = @trail.getRating %></h1>

<h2> Reviews: </h2>
<% if @trail.reviews.any? %>
  <% @trail.reviews.each do |review| %>
    <div class="fluid-container">
    <p>
	  Title: <%= review.title %> </br>
	  Review: <%= review.bodyText %> </br>
	  Rating: <%= review.rating %> </br>
	  Date: <%= review.created_at %> </br>
	  User: <%= link_to User.find(review.user_id).username, user_path(User.find(review.user_id)) %> </br>

	  <% if review.comments.any? %>
	  	<h3> Comments: </h3> 
	 	<% review.comments.each do |comment| %>
	 		</br>
	 		<%= comment.text %> </br>
	 		User: <%= link_to User.find(comment.user_id).username, user_path(User.find(comment.user_id)) %> </br>
	 		Date: <%= comment.created_at %>
	 		</br>

	 	<% end %>
	 <% end %>

	  <% if review.photos.any? %>
  	  <% review.photos.each do |photo| %>
	  <% unless photo.image_file_name.nil? %>
	    	<%= link_to image_tag(photo.image, :size=> "64x64"), photo.image(:original), :popup=>['original_image', 'height=700', 'width=900'] %>
	  <% end %>
	 <% end %>
	<% end %>
	
	</br>
	<%= form_for Comment.new do |f| %>
		<%= f.label :comment %>
		<br/>
		<%= f.text_area :text %>
		<br/>

		<%= f.hidden_field :review_id, :value => review.id %>
		<%= f.hidden_field :user_id, :value => current_user.id %>
		<%= f.submit %>
	<% end %>



    </p>

	<p>
     <%= button_to "Delete", { :controller => "reviews", :action => "deleteReview", :trail_id => @trail.id, :review_id => review.id} %>
     </p>
	</div>

  <% end %>
<% end %>

<br/>
<br/>

<div class="fluid-container" style="border:2px solid blue">
<h1>Add a Review</h1>
<%= form_for Review.new, :html => {:multipart => true}  do |f| %>
	<%= f.label :title %>
	<%= f.text_field :title %> 
	<br/>
	<%= f.label :review %>
	<br/>
	<%= f.text_area :bodyText %>
	<br/>
	<%= f.label :rating %>
	<%= f.select :rating, [[1, 1],[2, 2],[3, 3] , [4, 4], [5, 5]] %>

	<br/>

	<%= f.hidden_field :trail_id, :value => @trail.id %>
	<%= f.hidden_field :user_id, :value => current_user.id %>


	<%= f.label :photos %>
	<%= f.file_field :photos, multiple: true %>
	</br>
	<%= f.submit %>
<% end %>
</div>
